# Реферат по дисциплине «Администрирование информационных систем»: «Принципы Infrastructure as Code (IaC): обзор инструментов (Ansible, Terraform) и практика применения.»

## Содержание

[Введение](#введение)

[1. Теоретическая часть.](#1-теоретическая-часть)

[1.1 Основные принципы Infrastructure as Code](#11-основные-принципы-infrastructure-as-code)

[1.2 Архитектурные модели IaC](#12-архитектурные-модели-iac)

[1.3 Обзор инструмента Ansible](#13-обзор-инструмента-ansible)

[1.4 Обзор инструмента Terraform](#14-обзор-инструмента-terraform)

[2. Практическая часть](#2-практическая-часть)

[Заключение](#заключение)

[Список литературы](#список-литературы)

## Введение

Информационные системы современного масштаба требуют высокой степени надежности, быстроты развертывания и предсказуемости поведения. Рост количества сервисов и усложнение инфраструктурных решений привели к тому, что традиционные методы ручной настройки перестали обеспечивать необходимую стабильность и скорость реакции на изменения. Администратору приходится обслуживать разнородные среды, поддерживать согласованность конфигураций и контролировать зависимости между компонентами. В условиях постоянного роста нагрузок и расширения сетевых структур ручные операции становятся источником ошибок и затрудняют контроль состояния системы.

Инфраструктурный подход, основанный на автоматизации, стал естественным ответом на усложнение ИТ-сред. Применение описаний для управления конфигурациями позволило перейти от непосредственного выполнения команд к работе со структурированными файлами, которые задают желаемое состояние среды и позволяют воспроизводить его на любых совместимых платформах. Такой подход дает возможность использовать механизмы контроля версий, внедрять практики командной разработки, применять процессы тестирования и проверки корректности перед внесением изменений.

Infrastructure as Code сформировался как ключевое направление развития системного администрирования. Он объединяет инфраструктуру и программные методы, позволяя описывать сервисы и зависимости в виде конфигурационных файлов. Это привело к сокращению сроков развертывания, снижению вероятности ошибок и повышению уровня управляемости. Инструменты IaC дают возможность стандартизировать работу с серверами, сетевыми компонентами и облачными ресурсами в единой модели.

Актуальность использования IaC обусловлена потребностью организаций в гибком масштабировании и быстром внедрении изменений. Многие компании перешли к облачным платформам, где среда может меняться динамически, и без автоматизации контроль становится невозможным. В таких условиях инструменты IaC предоставляют единый подход к созданию и обновлению инфраструктуры, что помогает упорядочить процессы и повысить эффективность эксплуатации.

## 1. Теоретическая часть

### 1.1 Основные принципы Infrastructure as Code

Появление принципов Infrastructure as Code связано с переходом от традиционной модели обслуживания серверов к более структурированным и предсказуемым процессам управления инфраструктурой. В первые годы развития ИТ-систем конфигурации применялись вручную: администраторы настраивали сервера по инструкциям, выполняли команды на каждой машине, фиксировали изменения в отдельных документах. Такой подход был приемлем в эпоху небольших локальных систем, но с ростом числа сервисов и усложнением архитектур проявились ограничения ручного управления. Несогласованность конфигураций, невозможность точного воспроизведения окружения и высокая зависимость от конкретных специалистов стали серьезными препятствиями.

С распространением облачных платформ и виртуализации возникла необходимость в инструментах, которые могли бы автоматически создавать, изменять и поддерживать инфраструктуру. Развитие методологий DevOps способствовало появлению практик, объединяющих разработку и эксплуатацию. В процессе эволюции сформировалась идея описания инфраструктуры в виде конфигурационных файлов, которые можно хранить в системах контроля версий, передавать между командами и использовать для повторяемого развертывания. Этот подход заложил основу концепции IaC, позволив воспринимать инфраструктуру как программный код.

Основополагающим принципом Infrastructure as Code является декларативное описание желаемого состояния системы. В конфигурационных файлах фиксируются параметры ресурсов, зависимости и настройки, а инструменты IaC приводят инфраструктуру к указанному состоянию. Декларативное управление исключает необходимость выполнения пошаговых команд вручную и повышает устойчивость к человеческим ошибкам. Императивный метод также используется, но в меньшей степени; он предполагает явное указание последовательности действий, что делает процесс менее универсальным, хотя и предоставляет больший контроль в отдельных случаях.

Важное понятие IaC — идемпотентность. Оно означает, что повторное применение одной и той же конфигурации не приводит к непредсказуемым изменениям. Инструмент просто проверяет текущее состояние и корректирует его, если оно отличается от желаемого. Благодаря этому свойству удается исключить накопление ошибок и отклонений от стандарта. Идемпотентность обеспечивает стабильность и облегчает обновление окружений.

Контроль версий играет значительную роль, поскольку инфраструктура становится объектом разработки. Команды могут хранить файлы конфигураций в репозиториях, отслеживать изменения, проводить код-ревью и выполнять тестирование. Такой подход делает инфраструктуру прозрачной и документированной, а восстановление после сбоев упрощается благодаря возможности возврата к предыдущим версиям.

Воспроизводимость конфигураций позволяет развертывать идентичные окружения для тестирования, разработки и эксплуатации. Наличие структурированного описания гарантирует, что системы будут работать одинаково независимо от того, кто запускает процесс развертывания и в какой среде он выполняется. Масштабируемость также усиливается, так как автоматизированные процессы легко адаптируются к росту нагрузки и появлению новых сервисов.

### 1.2 Архитектурные модели IaC

Архитектурные модели IaC определяют способ взаимодействия с инфраструктурой и порядок внесения изменений в рабочие окружения. При выборе модели администратору необходимо учитывать характер сервисов, требования к стабильности и особенности процессов обновления. Две основные концепции, используемые при реализации IaC, представлены моделями Mutable и Immutable инфраструктур, каждая из которых формирует собственный подход к жизненному циклу ресурсов.

Модель Mutable опирается на идею постепенного изменения существующих рабочих узлов. Инфраструктура в этом случае воспринимается как набор долгоживущих систем, которые обновляются по мере необходимости. В процессе эксплуатации на таких узлах могут устанавливаться дополнительные пакеты, корректироваться параметры служб или изменяться конфигурационные файлы. Изменения применяются точечно, что позволяет оперативно вносить корректировки и поддерживать устойчивость сервиса без развертывания нового окружения. Такой подход удобен в ситуациях, когда требуется сохранять накопленное состояние, например данные локальных приложений или временные результаты вычислений.

Однако Mutable модель приводит к постепенному расхождению конфигураций между серверами. Каждое исправление, примененное вручную или в автоматическом режиме, может повлиять на поведение системы и создать уникальные отличия от остальных узлов. В условиях большой инфраструктуры эти различия усложняют диагностику ошибок и увеличивают затраты на обслуживание. Управление жизненным циклом ресурсов требует контроля каждой стадии обновления, а также отслеживания возможных отклонений, которые могут возникать при длительной эксплуатации серверов.

Модель Immutable использует другой принцип. Вместо изменения существующих узлов она предполагает создание полностью новых экземпляров инфраструктуры при каждом обновлении. Конфигурации формируются заранее, а готовый экземпляр заменяет предыдущий. Такой подход делает каждый узел идентичным образцу, из которого он создается. Все конфигурации, зависимости и параметры фиксируются на этапе подготовки, что исключает накопление отличий между системами. В случае необходимости обновления выполняется развертывание нового шаблона, а старый удаляется после вывода из эксплуатации.

Подход Immutable создает более предсказуемую инфраструктуру, где каждое изменение фиксируется в новой версии шаблона. Это упрощает масштабирование, поскольку все узлы создаются по одному стандарту. При возникновении ошибок возможен быстрый откат к предыдущей версии путем разворачивания сохраненного образца. Модель особенно эффективна в облачных средах, где процесс создания новых ресурсов автоматизирован и не требует больших затрат времени.

При сравнении моделей становится заметно, что Mutable ориентирована на постепенные корректировки, тогда как Immutable концентрируется на полном обновлении инфраструктуры. Каждая из них находит применение в разных условиях: первое решение подходит для систем, где важна длительная непрерывность работы конкретного узла, второе незаменимо при необходимости строгой стандартизации и быстрого воспроизведения окружений. Выбор подхода напрямую влияет на архитектуру процессов, способ обновления сервисов и стратегию контроля качества инфраструктуры.

### 1.3 Обзор инструмента Ansible

Ansible был создан Майклом Диханном в 2012 году как решение для упрощения управления конфигурациями и автоматизации рутинных задач. На момент появления у многих компаний уже существовали инструменты для конфигурационного управления, однако они требовали установки агентов, сложной настройки или работы с громоздкими системами. Администраторы сталкивались с ситуациями, когда каждый новый сервер нуждался в предварительной подготовке и установке специализированного клиента, без которого платформа автоматизации не могла взаимодействовать с системой. Это усложняло процесс внедрения и снижало гибкость управления.

Идея Ansible заключалась в создании инструмента, который работал бы без дополнительного программного обеспечения на целевых узлах. Взаимодействие через SSH позволяло начать работу с любым сервером, который был доступен по сети и имел стандартные средства удаленного управления. Такой подход значительно уменьшил порог входа и сделал инструмент особенно востребованным в средах, где нужно было быстро автоматизировать набор однотипных операций. Простота became одним из ключевых преимуществ Ansible: описания задач создавались на YAML, что делало конфигурации понятными и удобными для чтения.

В период своего активного распространения Ansible предлагал решение насущной проблемы отсутствия легкого и прозрачного инструмента, который одновременно мог выполнять конфигурационное управление и оркестрацию. Возможность объединять серверы в группы, применять к ним плейбуки и выполнять действия от простых команд до комплексных сценариев сделала его универсальным средством администрирования. Он хорошо подходил для серверов, где конфигурации менялись постепенно, и давал способ централизованно контролировать состояние систем.

Со временем структура инфраструктур стала меняться, и ориентир переместился в сторону облаков, контейнеров и моделей, построенных вокруг Immutable принципов. Многие современные приложения больше не требуют тонкой настройки серверов вручную, поскольку используются заранее подготовленные образы или контейнерные шаблоны. В таких условиях инструмент, ориентированный на постепенное изменение существующих узлов, оказался менее востребованным в качестве основного средства построения инфраструктуры. Кроме того, Ansible стал сложнее в масштабировании, особенно при работе с большими объемами задач и разветвленными конфигурациями. Управление состояниями, которое было слабой стороной изначальной архитектуры, сохраняет свои ограничения и сейчас.

Несмотря на это, Ansible продолжает активно применяться по нескольким причинам. Первой является простота внедрения: инструмент запускается практически сразу без подготовки целевых систем. Второй причиной остается гибкость. Множество задач, особенно связанных с администрированием уже работающих серверов, по-прежнему удобнее выполнять с помощью Ansible, чем через системы, требующие полного пересоздания узлов. Третьим фактором является огромная база готовых ролей, модулей и сценариев, которые накопились за годы использования. Эти ресурсы позволяют выполнять задачи без написания всего с нуля и делают инструмент ценным для множества организаций. Кроме того, Ansible хорошо подходит для смешанных сред, где требуется и автоматизация конфигураций, и выполнение отдельных задач оперативного характера.

### 1.4 Обзор инструмента Terraform

Terraform был создан компанией HashiCorp в 2014 году под руководством Митчелла Хашимото как инструмент, способный унифицировать управление инфраструктурой в условиях стремительного роста облачных платформ. На момент появления Terraform многие организации уже активно использовали облака, но каждая платформа предлагала собственные инструменты и форматы управления ресурсами. Администраторам приходилось работать с набором разрозненных утилит, каждая из которых имела свои команды, особенности и модели описания. Это создавало фрагментированность и усложняло создание единых процессов автоматизации, особенно в компаниях с мультиоблачными решениями.

Замысел Terraform был в том, чтобы предоставить единый декларативный язык для описания инфраструктурных ресурсов вне зависимости от того, где они развернуты. HashiCorp Configuration Language позволил описывать виртуальные машины, сети, балансировщики, базы данных и множество других ресурсов в формате удобных для восприятия конфигурационных файлов. Вместо ручного создания или изменения облачных объектов Terraform анализировал текущее состояние, формировал план изменений и затем приводил инфраструктуру к желаемому виду. Эта схема избавляла от непредсказуемых действий и обеспечивала повторяемость.

Основной проблемой, которую решал Terraform, было отсутствие централизованного подхода к управлению инфраструктурами в крупных компаниях. Каждый облачный провайдер предлагал разные интерфейсы, и поддержка нескольких платформ требовала значительных усилий. Terraform объединил работу с ними через систему провайдеров, которая позволяет расширять функциональность в зависимости от используемых сервисов. Это сделало его полезным инструментом в средах, где инфраструктура распределена по разным площадкам или должна гибко мигрировать между ними.

С ростом популярности облаков Terraform стал одним из ключевых инструментов для построения инфраструктуры в стиле Immutable. Он позволял создавать готовые окружения с нуля, не изменяя существующие ресурсы, а заменяя их новыми версиями. Это хорошо сочеталось с современными архитектурами, где важна предсказуемость, стандартизация и возможность быстрого отката. Инструмент органично вписался в практики DevOps и помог выстроить автоматизированные процессы развертывания в масштабах больших организаций.

В то же время Terraform со временем столкнулся с рядом ограничений. Управление состоянием ресурса оказалось одной из наиболее чувствительных частей инструмента. Файл состояния должен оставаться целостным и согласованным, что усложняет параллельную работу команды и требует надежного удаленного хранилища. Кроме того, рост числа провайдеров привел к неодинаковому качеству их реализации, что вызывает сложности при работе со специфическими или малораспространенными сервисами. Некоторые компании столкнулись с тем, что крупные проекты на Terraform требуют сложной структуры модулей, и поддержка таких конфигураций со временем становится трудоемкой.

Несмотря на эти сложности, Terraform остается одним из наиболее распространенных средств IaC. Его актуальность объясняется несколькими факторами. Первым является независимость от конкретной платформы. Инструмент одинаково подходит для AWS, Azure, GCP и множества других провайдеров, что значительно упрощает управление гибридными инфраструктурами. Вторым фактором стало широкое сообщество, которое создало много готовых модулей и практик, ускоряющих внедрение. Третьим является стабильность декларативного подхода: Terraform предоставляет понятный механизм планирования изменений, который помогает избежать ошибок при сложных операциях.

## 2. Практическая часть

Практическая часть представлена в виде обзорного примера применения Infrastructure as Code для автоматизации подготовки серверов и развертывания сервисов с помощью Ansible. В данном описании не ставится цель дать полную инструкцию или техническое руководство. Задача состоит в том, чтобы показать, как IaC позволяет управлять инфраструктурой в предсказуемом виде и каким образом Ansible применяется для выполнения типовых задач администрирования.

Рабочая конфигурация состоит из нескольких плейбуков, которые последовательно подготавливают систему, настраивают необходимые компоненты и запускают контейнерные сервисы. В начале определяется инвентарь, содержащий список хостов и параметры подключения. Для каждого сервера задается имя, адрес, порт, пользователь и путь к каталогу с SSH-ключами. Такой подход фиксирует в одном месте сведения о том, какие узлы входят в инфраструктуру, а также обеспечивает стандартизированное подключение к ним.

Первый этап автоматизации заключается в создании служебного пользователя, через которого будут выполняться все дальнейшие задачи. Это позволяет отделить технические операции от рабочей деятельности на сервере. Для этого используется плейбук:

```yaml
---
# Создаем Ansible пользователя. Все задания пойдут через него. Ключи хранятся в ssh_keys.
- name: Create ansible user
  hosts: all
  become: true

  pre_tasks:
    - name: Install sudo and acl
      ansible.builtin.package:
        name:
          - sudo
          - acl # FIXME Переместить в 01-hardening?
        state: present
  roles:
    - role: robertdebock.users
  vars:
    users:
      - name: ansible
        groups:
          - sudo
        sudo_options: "ALL=(ALL) NOPASSWD: ALL"
        manage_ssh_key: true
        users_ssh_key_directory: "{{ users_ssh_key_directory }}"
```

Сценарий показывает типичную структуру: предварительная установка зависимостей, вызов роли и передача переменных. После применения такого плейбука на всех серверах появляется пользователь, имеющий нужные полномочия. Далее к этому пользователю добавляется публичный ключ, который позволяет выполнять операции Ansible без пароля. Ручное вмешательство в этот процесс не требуется.

Следующий этап связан с подготовкой системы с точки зрения безопасности. Ansible позволяет подключать готовые роли, которые реализуют проверенные практики hardening. Например, включение автоматических обновлений безопасности или применение настроек, повышающих устойчивость операционной системы к атакам. В плейбуке это выглядит как подключение нескольких ролей подряд, где каждая отвечает за свою область. Такой подход демонстрирует один из принципов IaC: безопасность становится не разовой операцией, а постоянно воспроизводимым элементом конфигурации.

Для запуска контейнерных сервисов требуется заранее установить Docker. Плейбук установки использует роль из сообществ, которая автоматизирует загрузку необходимых пакетов и настройку служб. В нем же задаются параметры логирования, например:
docker_daemon_options: { “log-opts”: { “max-size”: “10m”, “max-file”: “5” } }
Фиксация таких параметров в плейбуке позволяет обеспечить одинаковое поведение инфраструктуры, независимо от того, на каком сервере выполняется установка.

После подготовки среды можно развертывать сервисы. В рассматриваемом примере используется Traefik в качестве реверс-прокси. Для его запуска применяется модуль, который работает с Docker Compose. В плейбуке задается структура сервиса: образ, порты, параметры команд и подключаемые тома. Пример фрагмента:

```yaml
---
- name: Install traefik
  hosts: all
  become: true
  tasks:
    - name: Install traefik
      community.docker.docker_compose_v2:
        project_name: traefik
        recreate: always
        definition:
          services:
            traefik:
              image: traefik:3
              restart: unless-stopped
              ports:
                - 80:80
                - 443:443
              command:
                - "--api"
                - "--providers.docker=true"
                - "--providers.docker.exposedByDefault=false"
                - "--entrypoints.web.address=:80"
              volumes:
                - /var/run/docker.sock:/var/run/docker.sock
```

Здесь видно, что вся конфигурация Traefik, включая параметры запуска и взаимодействие с Docker, описана в декларативном виде. При изменении описания структура будет автоматически пересоздана. Это избавляет от необходимости вручную редактировать файлы на серверах и следить за консистентностью настроек.

Важной особенностью является то, что переменные, определяющие конкретные настройки Traefik и параметры маршрутизации, хранятся не в плейбуке, а в инвентаре. Таким образом один и тот же код можно применять к разным окружениям, меняя только параметры. Например, хосты могут иметь уникальные домены или наборы служб, но структура автоматизации остается общей.

Представленный пример демонстрирует ключевую идею Infrastructure as Code: вся логика работы инфраструктуры выражена в виде файлов, которые можно просмотреть, проверить и воспроизвести на новом сервере. Развертывание сводится к запуску плейбуков, а состояние окружения становится предсказуемым и единообразным. Любое изменение фиксируется как правка конфигурации, а не как набор действий команд, которые сложно воспроизвести вручную.

## Заключение

В ходе работы был рассмотрен подход Infrastructure as Code и ключевые принципы, которые лежат в основе его применения в современных информационных системах. Изучены архитектурные модели IaC, показывающие различия между подходами Mutable и Immutable и их влияние на построение инфраструктуры. Приведен обзор инструмента Ansible, включающий причины его появления, задачи, которые он решал на момент создания, особенности его использования сегодня и факторы, благодаря которым он по-прежнему остается востребованным. Рассмотрен Terraform как инструмент декларативного управления ресурсами, созданный для унификации взаимодействия с облачными платформами, а также причины его широкого распространения и существующие ограничения.

Практическая часть показала, как подход IaC реализуется на примере Ansible в реальной инфраструктуре. Продемонстрировано применение плейбуков для создания служебного пользователя, усиления безопасности системы, установки Docker и развертывания реверс-прокси Traefik. Представленный пример иллюстрирует, каким образом декларативные описания позволяют стандартизировать конфигурации, автоматизировать подготовку серверов и обеспечить воспроизводимость настроек.

Рассмотренные материалы подтверждают, что использование IaC упрощает управление инфраструктурой, уменьшает объем ручных действий, делает конфигурации прозрачными и легко проверяемыми. Такие инструменты, как Ansible и Terraform, позволяют выстроить предсказуемые процессы развертывания и модернизации систем, обеспечивая стабильность и удобство сопровождения даже при значительном масштабе инфраструктуры.

## Список литературы

1. HASHICORP. Terraform Documentation. Электронный ресурс. Режим доступа: <https://developer.hashicorp.com/terraform>
2. ANSIBLE COMMUNITY. Ansible Documentation. Электронный ресурс. Режим доступа: <https://docs.ansible.com>
3. DevSec Hardening Framework. Security Hardening Roles Documentation. Электронный ресурс. Режим доступа: <https://github.com/dev-sec>
4. Jeff Geerling. Docker Ansible Role Documentation. Электронный ресурс. Режим доступа: <https://github.com/geerlingguy/ansible-role-docker>
5. Red Hat. Infrastructure as Code: Concepts and Practices. Электронный ресурс. Режим доступа: <https://www.redhat.com/en/topics/automation/what-is-infrastructure-as-code-iac>
6. AWS Architecture Blog. IaC Patterns and Best Practices. Электронный ресурс. Режим доступа: <https://aws.amazon.com/blogs/architecture>
7. Google Cloud. Infrastructure as Code Overview. Электронный ресурс. Режим доступа: <https://cloud.google.com/docs/terraform>
8. IBM Cloud. Automating infrastructure with IaC. Электронный ресурс. Режим доступа: <https://www.ibm.com/cloud/learn/infrastructure-as-code>
9. HashiCorp. Terraform: Up and Running – Recommended Resources. Электронный ресурс. Режим доступа: <https://www.terraformupandrunning.com>
10. HashiCorp Blog. Evolution of Terraform and IaC Ecosystem. Электронный ресурс. Режим доступа: <https://www.hashicorp.com/blog>
